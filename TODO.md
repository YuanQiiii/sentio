# Sentio AI 开发计划 (TODO)

## 📊 项目当前状态

🎉 **核心功能已完成**: Sentio AI 已具备完整的智能邮件助手能力！

### ✅ 已完成的功能

- **配置管理**: 支持环境变量和 YAML 配置文件
- **LLM 集成**: DeepSeek API 集成，配置驱动的提示词管理
- **邮件发送**: 完整的 SMTP 客户端，支持 TLS 加密
- **记忆系统**: 用户档案和交互历史管理 (MongoDB 实现)
- **核心工作流**: 邮件分析 → 记忆检索 → 智能回复 → 历史记录
- **错误处理**: 优雅降级，完整的错误处理和日志记录

### 🚀 可立即使用的场景

1. **智能邮件回复**: 分析收到的邮件内容，生成个性化回复
2. **用户记忆管理**: 记录并学习用户的交互历史和偏好
3. **配置化部署**: 通过环境变量快速配置不同环境

### 🔧 运行要求

- **必需**: Rust 1.70+, DeepSeek API Key
- **可选**: MongoDB (当前实现使用，将被移除)

---

## 里程碑 1: 完善基础服务和配置 ✅ **已完成**

- [x] **数据库配置**:
  - [x] 在 `sentio_memory` 服务中实现完整的数据库连接和初始化逻辑。
  - [x] 根据 `README.md` 中的描述，为所有记忆类型（个人档案、交互历史、语义记忆等）定义数据模型。
  - [x] 为 `sentio_memory` 服务编写集成测试，确保数据库的增删改查（CRUD）操作正常。
- [x] **配置和环境**:
  - [x] 完善 `.env.example` 文件，包含所有必要服务的配置项。
  - [x] 确保 `shared_logic` 中的配置加载对所有服务都健壮可靠。

## 里程碑 2: 实现核心功能 - 记忆系统 ✅ **已完成**

- [x] **个人档案管理**:
  - [x] 实现对用户个人档案（基本信息、关系网络、性格特征）的 CRUD 操作。
- [x] **交互历史记录**:
  - [x] 实现记录邮件交互（发件人、收件人、时间、内容摘要、情感分析结果）的功能。
- [x] **语义、行动和策略记忆**:
  - [x] 设计并实现存储用户偏好、习惯和重要事件的语义记忆模块。
  - [x] 设计并实现存储待办事项、跟进提醒的行动记忆模块。
  - [x] 设计并实现存储 AI 沟通策略和自我反思的策略记忆模块。

## 里程碑 3: 实现核心功能 - 邮件集成 ✅ **已完成**

> **注意**: 根据用户需求，只实现 SMTP 邮件发送功能，不需要 IMAP 邮件接收。

- [x] **邮件发送 (SMTP)**:
  - [x] 实现 SMTP 客户端，支持安全的邮件发送。
  - [x] 实现基本的文本邮件发送功能。
  - [x] 完善 SMTP 操作的错误处理和重试机制。

## 里程碑 4: 实现核心功能 - 智能引擎与服务编排 ✅ **已完成**

- [x] **服务编排 (`sentio_core`)**:
  - [x] 实现 `sentio_core` 的主工作流程：
    1. [x] 根据邮件信息，从 `sentio_memory` 检索相关记忆。
    2. [x] 调用 `sentio_llm` 进行邮件分析或生成回复草稿。
    3. [x] 将新的分析结果或交互存入 `sentio_memory`。
    4. [x] 通过 `sentio_email` 发送智能回复。
- [x] **智能推理 (`sentio_llm`)**:
  - [x] 实现配置驱动的 LLM 调用，支持提示词外置管理。
  - [x] 实现基于用户画像和记忆系统的个性化回复生成。
  - [x] 实现情感分析功能，并将结果与交互历史关联。
  - [ ] 实现基于思考链（Chain of Thought）的深度推理功能。

**核心工作流程已实现**:

- ✅ 邮件内容分析和理解
- ✅ 用户记忆检索和个性化 (当前基于 MongoDB)
- ✅ 智能回复生成
- ✅ 交互历史记录和学习
- ✅ 完整的错误处理和降级策略

## 里程碑 5: 部署与运维 ✅ **数据库基础设施已完成**

- [x] **数据库基础设施**:
  - [x] 编写 `docker-compose.yml`，用于一键启动 MongoDB 数据库。
  - [x] 编写数据库初始化脚本，创建必要的用户和权限。
  - [x] 编写部署脚本，简化 MongoDB 启动流程。
- [ ] **可观测性增强**:
  - [ ] 增强 `sentio_telemetry`，实现全链路的结构化日志记录。
  - [ ] 添加核心指标监控（如邮件处理时间、LLM 调用次数、错误率等）。

---

## 🎯 剩余任务优先级

### 高优先级 (核心功能)

1. **内存数据库实现** - 替换 MongoDB 依赖 ✅ **已完成**
   - [x] 实现线程安全的内存存储 (Arc<RwLock>)
   - [x] 完成核心 CRUD 操作
   - [x] 添加基本数据验证
   - [x] 添加指标跟踪 (reads/writes, query hits/misses)
2. **思考链推理** - 提升 AI 回复的逻辑性
3. **指标监控增强** - 生产环境运维支持

### 中优先级 (功能增强)

1. **性能优化** - 大规模使用时的性能调优
2. **多语言支持** - 国际化功能
3. **Web 界面** - 用户友好的管理界面

### 低优先级 (优化和扩展)

1. **持久化存储** - 未来可选的后端存储
2. **缓存优化** - 高频访问数据缓存
3. **数据加密** - 敏感信息保护

## 📝 快速开始指南

1. **配置环境**:

   ```bash
   cp .env.example .env
   # 编辑 .env 文件，填入您的 DeepSeek API Key
   # 注意: 当前版本需要 MongoDB 运行实例
   ```

2. **运行系统**:

   ```bash
   cargo run -p sentio_core
   ```

3. **测试工作流程**: 系统将自动运行演示，展示完整的邮件处理流程
